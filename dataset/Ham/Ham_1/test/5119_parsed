 this is a multi-part messag in mime format it has been sign conform to number you'll need gpg or pgp to check the signatur number content-typ multipart/mix number content-transfer-encod number number content-typ text/plain charset=us-ascii i'm a veri happi user of exmh but i'm paranoid also :-) therefor i'm not too happi with exmh cach my pgp passphras usual i use a relat secur tool call quintupl agent URL to store my passphras and i'v just ad the few line of code to exmh which allow for such extern cach the patch is attach it is against version number (debian) and the file modifi are extrasinit.tcl and pgpexec.tcl i'v ad three new prefer in the general pgp section which allow everybodi to use his/her favourit extern tool to get the passphras (everyth which spit out the phrase on stdout is ok) i'd be happi if somebodi with cvs access think that this stuff is worth to be ad and doe so apart from that i'm happi for suggest comment or critiqu (mind you i'm not exact a special friend of tcl so my code may leav thing to be desired...) regard az number content-typ text/plain charset=us-ascii content-disposit attach filename="exmh-patch" content-transfer-encod number --- /usr/lib/exmh/extrasinit.tcl sat mar number number number +++ ./extrasinit.tcl fri sep number number number email number number email {pgp(passtimeout) pgppasstimeout number {minut to cach pgp passphrase} "exmh will clear it memori of pgp passphras after this time period in minut has elapsed." } +{pgp(extpass) pgpextpass off {use extern passphras cache} +"if this is enabl then exmh will use an extern program to retriev +your passphras when need pgpkeeppass and pgppasstimeout will +be ignored."} +{pgp(getextcmd) pgpgetextcmd {/usr/bin/q-cli get percent {method to queri extern passphras cache} +"this extern program is use to retriev the passphras for your key +if pgpextpass is activ the passphras is expect on stdout +the key id is substitut with percent (use format)." } +{pgp(delextcmd) pgpdelextcmd {/usr/bin/q-cli delet percent {method to invalid extern passphras cache} +"this extern program is use to delet the passphras for your key +from the extern cach if pgpextpass is activ +the key id is substitut with percent (use format)." } } # make sure we don't inherit a bad pgp(version) from a previous setup --- /usr/lib/exmh/pgpexec.tcl sat mar number number number +++ ./pgpexec.tcl fri sep number number number email number number email proc pgp_getpass { v key } { global pgp + if {[info exist pgp(extpass)] && [set pgp(extpass)] \ + && [info exist pgp(getextcmd)]} { + exmh_debug "pgp_getpass dollar dollar external" + set keyid [lindex dollar number + set cmd [format dollar dollar + while number { + exmh_debug "run cmd dollar + if [ catch {exec sh -c dollar result ] { + exmh_debug "error run cmd dollar + exmh_status "error execut extern cmd" warn + return {} + } els { + if {[pgp_exec_checkpassword dollar dollar dollar { + return dollar + } els { + exmh_debug "bad passphrase" + if {[info exist pgp(delextcmd)]} { + exmh_debug "tri to invalid bad passphrase" + if [catch {exec sh -c "[format dollar dollar { + exmh_debug "invalid failed" + return {} + } + } + } + } + } + } els { exmh_debug "pgp_getpass dollar dollar if {[lsearch -glob [set dollar "[lindex dollar number  number { email number number email } return dollar } + } } } number content-typ text/plain charset=us-ascii -- + alexand zangerl + email + dsa number + (rsa number kind of like my number fund "wealth not found." -- shrox number number content-typ application/pgp-signatur name="signature.ng" content-disposit inlin filename="signature.ng" content-transfer-encod number -----begin pgp signature----- version gnupg number (gnu/linux) number number number -----end pgp signature----- number _______________________________________________ exmh-us mail list email URL