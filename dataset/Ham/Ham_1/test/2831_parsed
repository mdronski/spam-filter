 from email tue aug number number number return-path email delivered-to email receiv from localhost (localhost number by phobos.labs.netnoteinc.com (postfix) with esmtp id number for email tue number aug number number number (edt) receiv from phobo number by localhost with imap number for email (single-drop) tue number aug number number number (ist) receiv from outgoing.securityfocus.com number number by dogma.slashnull.org number with esmtp id number for email tue number aug number number number receiv from lists.securityfocus.com (lists.securityfocus.com number by outgoing.securityfocus.com (postfix) with qmqp id number tue number aug number number number (mdt) mailing-list contact email run by ezmlm preced bulk list-id  list-post email list-help email list-unsubscrib email list-subscrib email delivered-to mail list email delivered-to moder for email receiv (qmail number invok from network) number aug number number number date mon number aug number number number (pdt) message-id email x-authentication-warn freefall.freebsd.org nectar set sender to email use -f from freebsd secur advisori email to bugtraq email subject freebsd secur advisori number reply-to email -----begin pgp sign message----- ============================================================================= number secur advisori the freebsd project topic bug in nfs server code allow remot denial of servic categori core modul nfs announc number credit mike junk email affect all releas prior to number number prior to the correct date correct number number utc number number number utc number number number utc number number number utc number freebsd onli no i background the network file system (nfs) allow a host to export some or all of it filesystem or part of them so that other host can access them over the network and mount them as if they were on local disk nfs is built on top of the sun remot procedur call (rpc) framework ii problem descript a part of the nfs server code charg with handl incom rpc messag had an error which when the server receiv a messag with a zero-length payload would caus it to refer the payload from the previous messag creat a loop in the messag chain this would later caus an infinit loop in a differ part of the nfs server code which tri to travers the chain iii impact certain linux implement of nfs produc zero-length rpc messag in some case a freebsd system run an nfs server may lock up when such client connect an attack in a posit to send rpc messag to an affect freebsd system can construct a sequenc of malici rpc messag that caus the target system to lock up iv workaround number disabl the nfs server set the nfs_server_en variabl to "no" in /etc/rc.conf and reboot altern if there are no activ nfs client (as list by the number utility) just kill the mountd and nfsd process should suffic number add firewal rule to block rpc traffic to the nfs server from untrust host v solut the follow patch has been verifi to appli to freebsd number number and number system a) download the relev patch from the locat below and verifi the detach pgp signatur use your pgp util # fetch number # fetch number b) appli the patch # cd /usr/src # patch  /path/to/patch c) recompil your kernel and modul as describ in URL and reboot the system vi correct detail the follow list contain the revis number of each file that was correct in freebsd path revis branch - ------------------------------------------------------------------------- src/sys/nfs/nfs_socket.c number number number number number number number number - ------------------------------------------------------------------------- -----begin pgp signature----- version gnupg number (freebsd) number number number number number -----end pgp signature-----