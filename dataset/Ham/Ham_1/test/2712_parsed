 e-matt gmbh www.e-matters.d -= secur advisori =- advisori remot compromise/do vulner in php releas date number last modifi number author stefan esser email applic php number number sever a vulner within the multipart/form-data handler could allow remot compromis of the web server risk critic vendor status patch releas refer number overview we have discov a serious vulner within the default version of php depend on the processor architectur it may be possibl for a remot attack to either crash or compromis the web server detail php number introduc a complet rewritten multipart/form-data post handler while i was work on the code in my role as php develop i found a bug within the way the mime header are process a malform post request can trigger an error condit that is not correct handl due to this bug it could happen that an uninit- ialis struct get append to the link list of mime header when the list get clean or destroy php tri to free the pointer that are expect in the struct becaus of the lack of initialis those pointer contain stuff that was left on the stack by previous function call on the number architectur (aka number it is not possibl to control what will end up in the uninitialis struct becaus of the stack layout all possibl code path leav illeg address within the struct and php will crash when it tri to free them unfortun the situat is absolut differ if you look on a solari sparc instal here it is possibl for an attack to free chunk of memori that are full under his control this is most probabl the case for sever more non number architectur pleas note that exploit is not onli limit to system that are run malloc()/free() implement that are known to be vulner to control structur overwrit this is becaus the intern php memori manag implement it own link list system that can be use to overwrit near arbitrari memori address proof of concept e-matt is not go to releas the exploit for this vulner to the public vendor respons number juli number - an updat version of php which fix this vulner was releas and can be download at URL the vendor announc is avail at number recommend if you are run php number you should upgrad as soon as possibl especi if your server run on a non number cpu if you cannot upgrad for whatev reason the onli way to workaround this is to disabl all kind of post request on your server gpg-key URL pub number number e-matt gmbh - securityteam key fingerprint = number number number number number caeb number number number number copyright number stefan esser all right reserv